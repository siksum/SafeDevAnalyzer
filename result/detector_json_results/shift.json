{
  "incorrect-shift": {
    "success": false,
    "error": [
      null
    ],
    "results": {
      "filename": "/Users/sikk/Desktop/Antibug/SafeDevAnalyzer/test/detector/shift.sol",
      "detector": "incorrect-shift",
      "impact": "High",
      "confidence": "High",
      "element": [
        {
          "type": "function",
          "name": "f",
          "line": 13,
          "code": "    function f() internal pure returns (uint a) {\n",
          "parent_type": "contract",
          "parent_name": "Bar"
        },
        {
          "type": "node",
          "name": "a = 8 >>' a",
          "line": 15,
          "code": "            a := sar(a, 8)\n",
          "parent_type": "function",
          "parent_name": "f"
        }
      ],
      "info_korean": " `Bar.f()` í•¨ìˆ˜ëŠ” ì˜ëª»ëœ shift ì—°ì‚°ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. `a = 8 >>' a`",
      "description_korean": "\nì–´ì…ˆë¸”ë¦¬ í•¨ìˆ˜ì—ì„œ shift ì—°ì‚°ì„ ì‚¬ìš©í•  ë•Œ, íŒŒë¼ë¯¸í„°ì˜ ìˆœì„œê°€ ì˜ëª»ëœ ê²½ìš°ë¥¼ ê²€ì‚¬í•©ë‹ˆë‹¤.\n    ",
      "exploit_scenario_korean": "\n```solidity\ncontract C {\n    function f() internal returns (uint a) {\n        assembly {\n            a := shr(a, 8)\n        }\n    }\n}\n```\n`shr(a, 8)`: ë³€ìˆ˜ aì˜ ë¹„íŠ¸ë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ 8ê°œë§Œí¼ ì‹œí”„íŠ¸í•©ë‹ˆë‹¤. ì¦‰, aì˜ ê°’ì„ 8ë¹„íŠ¸ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤.\n`shr(8, a)`: ìˆ«ì 8ì„ ë³€ìˆ˜ aì˜ ë¹„íŠ¸ ìˆ˜ë§Œí¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì‹œí”„íŠ¸í•©ë‹ˆë‹¤. ë”°ë¼ì„œ a ë³€ìˆ˜ê°€ ì–´ë–¤ ê°’ì´ë“  ì•ˆì „í•˜ê²Œ 8 ë¹„íŠ¸ë§Œí¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì‹œí”„íŠ¸ë©ë‹ˆë‹¤.\n    \n`shl(a, 8)`: a ë³€ìˆ˜ê°€ ì‹œí”„íŠ¸ë©ë‹ˆë‹¤. a ë³€ìˆ˜ì˜ ê°’ê³¼ ë¹„íŠ¸ ê¸¸ì´ì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§Œì•½ aê°€ ì¶©ë¶„íˆ í° ê°’ì„ ê°–ê³  ìˆì–´ì„œ ì™¼ìª½ ì‹œí”„íŠ¸ë¡œ ì¸í•´ ë¹„íŠ¸ ê¸¸ì´ê°€ ë„˜ì–´ê°€ëŠ” ê²½ìš°, ì˜ˆìƒì¹˜ ëª»í•œ ê°’ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n`shl(8, a)`: 8ì´ ê³ ì •ëœ ê°’ì„ ì‹œí”„íŠ¸í•˜ëŠ” ê²ƒì´ë¯€ë¡œ ì‹œí”„íŠ¸ ì—°ì‚°ì˜ ê²°ê³¼ëŠ” a ë³€ìˆ˜ì˜ ê°’ì—ë§Œ ì˜ì¡´í•©ë‹ˆë‹¤. ë”°ë¼ì„œ a ë³€ìˆ˜ê°€ ì–´ë–¤ ê°’ì´ë“  ì•ˆì „í•˜ê²Œ 8 ë¹„íŠ¸ë§Œí¼ ì™¼ìª½ìœ¼ë¡œ ì‹œí”„íŠ¸ë©ë‹ˆë‹¤.\n\n`sar(a, 8)`: ë³€ìˆ˜ aì˜ ë¹„íŠ¸ë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ì‹œí‚¤ë¯€ë¡œ aì˜ í˜„ì¬ ê°’ì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. \n`sar(8, a)`: í•­ìƒ ìƒìˆ˜ 8ì˜ ë¹„íŠ¸ ì´ë™ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ë¯€ë¡œ aì˜ í˜„ì¬ ê°’ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³  ì¼ê´€ëœ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n",
      "recommendation_korean": "\në³´í†µì€ `sar(8, a)`, `shl(8, a)`, `shr(8, a)`ê°€ ë” ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³  ì•ˆì „í•œ ë°©ë²•ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì œ ìƒí™©ê³¼ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ì— ë”°ë¼ì„œ ë‹¤ë¥¸ ë°©ì‹ì´ ë” ì í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê²°ì •ì€ í”„ë¡œê·¸ë¨ì˜ ìš”êµ¬ ì‚¬í•­ê³¼ ëª©ì ì— ë”°ë¼ ë‹¤ë¥´ë¯€ë¡œ ì£¼ì˜ ê¹Šê²Œ ê²€í† í•˜ê³  ì ì ˆí•œ ë°©ë²•ì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.\në˜í•œ, solidity yul codeëŠ” Overflow/Underflowë¥¼ ê²€ì‚¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì´ëŸ¬í•œ ì¼€ì´ìŠ¤ë¥¼ ê³ ë ¤í•˜ì—¬ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.\n    ",
      "reference": "\n- https://ethereum.stackexchange.com/questions/127538/right-shift-not-working-in-inline-assembly\n- https://docs.soliditylang.org/en/v0.8.23/types.html#value-types:~:text=Before%20version%200.5.0%20a%20right%20shift%20x%20%3E%3E%20y%20for%20negative%20x%20was%20equivalent%20to%20the%20mathematical%20expression%20x%20/%202**y%20rounded%20towards%20zero%2C%20i.e.%2C%20right%20shifts%20used%20rounding%20up%20(towards%20zero)%20instead%20of%20rounding%20down%20(towards%20negative%20infinity).\n- https://docs.soliditylang.org/en/v0.8.23/types.html#value-types:~:text=Overflow%20checks%20are%20never%20performed%20for%20shift%20operations%20as%20they%20are%20done%20for%20arithmetic%20operations.%20Instead%2C%20the%20result%20is%20always%20truncated.    \n    "
    }
  },
  "incorrect-return": {
    "success": false,
    "error": [
      null
    ],
    "results": {
      "filename": "/Users/sikk/Desktop/Antibug/SafeDevAnalyzer/test/detector/shift.sol",
      "detector": "incorrect-return",
      "impact": "High",
      "confidence": "Medium",
      "element": [
        {
          "type": "function",
          "name": "foo",
          "line": 22,
          "code": "    function foo() public pure returns(bool) {\n",
          "parent_type": "contract",
          "parent_name": "Foo"
        },
        {
          "type": "function",
          "name": "blockingFunction",
          "line": 7,
          "code": "    function blockingFunction() public pure returns (bool) {\n",
          "parent_type": "contract",
          "parent_name": "Bar"
        },
        {
          "type": "node",
          "name": "return(uint256,uint256)(0,0x20)",
          "line": 9,
          "code": "            return(0,0x20)\n",
          "parent_type": "function",
          "parent_name": "blockingFunction"
        }
      ],
      "info_korean": "í•¨ìˆ˜ `Foo.foo()`ê°€ í•¨ìˆ˜ `Bar.blockingFunction()`ë¥¼ í˜¸ì¶œí•˜ë©´, `return(uint256,uint256)(0,0x20)`ìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ íë¦„ì´ ì¤‘ë‹¨ë©ë‹ˆë‹¤.\n",
      "description_korean": "inline assembly blockì— returnì´ ì‚¬ìš©ë˜ë©´ ì˜ˆê¸°ì¹˜ ì•Šì€ ì‹¤í–‰ íë¦„ì´ ì¤‘ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
      "exploit_scenario_korean": "\n```solidity\n    contract C {\n        function f() internal returns (uint a, uint b) {\n            assembly {\n                return (5, 6)\n            }\n        }\n\n        function g() returns (bool){\n            f();\n            return true;\n        }\n    }\n```\nf í•¨ìˆ˜ì˜ return ë¬¸ì€ g í•¨ìˆ˜ì˜ ì‹¤í–‰ì„ ì¤‘ë‹¨ì‹œí‚µë‹ˆë‹¤.\ng í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ true ê°’ì„ ë°˜í™˜í•  ê²ƒì„ ê¸°ëŒ€í–ˆìœ¼ë‚˜ f í•¨ìˆ˜ì—ì„œ 5ë²ˆì§¸ offsetë¶€í„° 6ë°”ì´íŠ¸ë¥¼ ë°˜í™˜í•œ ë’¤ ì‹¤í–‰ì´ ì¤‘ë‹¨ë©ë‹ˆë‹¤.",
      "recommendation_korean": "0.6.0 ì´ìƒ ë²„ì „ë¶€í„° leave í‚¤ì›Œë“œê°€ ë“±ì¥í•˜ì˜€ìŠµë‹ˆë‹¤. ë§Œì•½ ì´ì „ ë²„ì „ì„ ì‚¬ìš©í•œë‹¤ë©´, 0.6.0 ì´ìƒ ë²„ì „ìœ¼ë¡œ ë³€ê²½í•œ í›„, solidityì˜ leave ë¬¸ì„ ì‚¬ìš©í•˜ì„¸ìš”.",
      "reference": "https://blog.ethereum.org/2019/12/03/ef-supported-teams-research-and-development-update-2019-pt-2#solidity-060:~:text=Add%20%22leave%22%20statement%20to%20Yul%20/%20Inline%20Assembly%20to%20return%20from%20current%20function"
    }
  },
  "assembly": {
    "success": false,
    "error": [
      null
    ],
    "results": {
      "filename": "/Users/sikk/Desktop/Antibug/SafeDevAnalyzer/test/detector/shift.sol",
      "detector": "assembly",
      "impact": "Informational",
      "confidence": "Low",
      "element": [
        {
          "type": "function",
          "name": "blockingFunction",
          "line": 7,
          "code": "    function blockingFunction() public pure returns (bool) {\n",
          "parent_type": "contract",
          "parent_name": "Bar"
        }
      ],
      "info_korean": "í•¨ìˆ˜ `Bar.blockingFunction()`ì—ì„œ `inline-assembly`ê°€ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.\n",
      "description_korean": "\n<details> \n    <summary style='font-size: 18px;color:pink;'> ğŸ’¡ Inline Assemblyë€? </summary><br />\n    \n`inline-assembly`ëŠ” EVMì— ì§ì ‘ì ìœ¼ë¡œ ìƒí˜¸ì‘ìš©í•˜ë©° high-levelì—ì„œ í•  ìˆ˜ ì—†ëŠ” ìˆ˜ì¤€ì˜ controlê³¼ ì •ë°€ë„ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.\n\nêµ¬ì²´ì ìœ¼ë¡œ, ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ì„ ì¡°ì •í•˜ê±°ë‚˜, íŠ¹ì • EVM ê¸°ëŠ¥ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nsolidityì—ì„œëŠ” EVM bytecodeë¡œ ì»´íŒŒì¼í•˜ë„ë¡ ì„¤ê³„ëœ ì¤‘ê°„ ì–¸ì–´ì¸ Yulì„ ì‚¬ìš©í•˜ì—¬ `inline-assembly`ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n    assembly{ â€¦ }\ní˜•íƒœë¡œ ì‘ì„±í•©ë‹ˆë‹¤.\n\n</details>\n<br />\n\nì¼ë°˜ì ìœ¼ë¡œ solidity ì»´íŒŒì¼ëŸ¬ëŠ” ë©”ëª¨ë¦¬ê°€ ì˜ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ìˆì§€ë§Œ, `inline-assembly`ë¥¼ ì‚¬ìš©í•˜ë©´ ì»´íŒŒì¼ëŸ¬ì˜ ê²€ì‚¬ë¥¼ ë²—ì–´ë‚˜ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ ì¡°ì‘ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n    \n",
      "exploit_scenario_korean": "\n```solidity\ncontract VulnerableContract {\n    uint8 public balance;\n\n    function deposit(uint8 amount) public {\n        assembly {\n            sstore(balance.slot, add(sload(balance.slot), amount))\n        }\n    }\n\n    function withdraw(uint8 amount) public {\n        require(amount <= balance, \"Insufficient balance\");\n        assembly {\n            sstore(balance.slot, sub(sload(balance.slot), amount))\n        }\n    }\n}\n```    \n`deposit` í•¨ìˆ˜ì—ì„œ `amount`ë¥¼ `balance`ì— ë”í•  ë•Œ `add` ëª…ë ¹ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n`balance`ê°€ ìµœëŒ“ê°’ì´ 255ì— ê°€ê¹Œì›Œì§„ ìƒíƒœì—ì„œ ë”í•˜ë ¤ê³  í•˜ë©´ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•˜ì—¬ `balance`ê°€ ê°ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n",
      "recommendation_korean": "`inline assembly` ì‚¬ìš©ì— ì£¼ì˜í•˜ì„¸ìš”.",
      "reference": "\n- https://medium.com/@ac1d_eth/technical-exploration-of-inline-assembly-in-solidity-b7d2b0b2bda8\n- [https://solidity-kr.readthedocs.io/ko/latest/assembly.html#:~:text=Inline assembly is a way to access the Ethereum Virtual Machine at a low level. This bypasses several important safety features and checks of Solidity. You should only use it for tasks that need it%2C and only if you are confident with using it](https://solidity-kr.readthedocs.io/ko/latest/assembly.html#:~:text=Inline%20assembly%20is%20a%20way%20to%20access%20the%20Ethereum%20Virtual%20Machine%20at%20a%20low%20level.%20This%20bypasses%20several%20important%20safety%20features%20and%20checks%20of%20Solidity.%20You%20should%20only%20use%20it%20for%20tasks%20that%20need%20it%2C%20and%20only%20if%20you%20are%20confident%20with%20using%20it).    \n    "
    }
  }
}