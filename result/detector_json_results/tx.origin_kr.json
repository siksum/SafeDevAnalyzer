{
  "tx-origin": {
    "success": true,
    "error": null,
    "results": {
      "filename": "/Users/sikk/Desktop/Antibug/SafeDevAnalyzer/test/tx.origin.sol",
      "detector": "tx-origin",
      "impact": "Medium",
      "confidence": "Medium",
      "element": [
        {
          "type": "node",
          "name": "require(bool,string)(tx.origin == owner,Not owner)",
          "line": 31,
          "code": "        require(tx.origin == owner, \"Not owner\");\n",
          "parent_type": "function",
          "parent_name": "transfer"
        }
      ],
      "info_korean": "í•¨ìˆ˜ `Wallet.transfer(address,uint256)`ì—ì„œ `tx.origin`ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.\n",
      "description_korean": "\n`tx.origin`ì€ ì²˜ìŒ íŠ¸ëœì­ì…˜ì„ í˜¸ì¶œí•œ ê³„ì •ì˜ ì •ë³´ë§Œ ì¶”ì í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>\nì—¬ëŸ¬ ì»¨íŠ¸ë™íŠ¸ í˜¸ì¶œì´ í¬í•¨ëœ ë³µì¡í•œ íŠ¸ëœì­ì…˜ì—ì„œ `EOA`ì˜ ì£¼ì†Œë¥¼ ì‹ë³„í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.<br>\nì´ëŸ¬í•œ ê²½ìš°, `tx.origin`ì„ ì‚¬ìš©í•˜ì—¬ `EOA`ì˜ ì£¼ì†Œë¥¼ ì‹ë³„í•  ìˆ˜ ì—†ì–´, ì¦‰ê°ì ì¸ ì»¨íŠ¸ë™íŠ¸ ìƒí˜¸ ì‘ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¸ë¶„í™”ëœ ì ‘ê·¼ ì œì–´ë¥¼ êµ¬í˜„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>\n\në˜í•œ, `tx.origin`ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì€ í”¼ì‹± ê³µê²©ì— ì·¨ì•½í•©ë‹ˆë‹¤.\n\n<p align=\"center\">\n<img src=\"https://i.imgur.com/4E1EkZA.png\" width=\"700\" height=\"500\">\n</p>\n\nê³µê²©ìëŠ” ì•…ì˜ì ì¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ì‚¬ìš©ìê°€ í•´ë‹¹ ì»¨íŠ¸ë™íŠ¸ë¥¼ í˜¸ì¶œí•˜ë„ë¡ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>\nì‚¬ìš©ìê°€ ì•…ì˜ì ì¸ ì»¨íŠ¸ë™íŠ¸ê³¼ ìƒí˜¸ ì‘ìš©í•˜ë©´, ê³µê²©ìëŠ” ì‚¬ìš©ìì˜ `EOA` ì£¼ì†Œë¥¼ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>\nì´í›„, ê³µê²©ìê°€ ì‚¬ìš©ìì˜ `EOA` ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨íŠ¸ë™íŠ¸ë¥¼ í˜¸ì¶œí•˜ë©´, `tx.origin`ì€ ì—¬ì „íˆ ì‚¬ìš©ìì˜ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¤ë¯€ë¡œ ê³µê²©ìë¥¼ í•©ë²•ì ì¸ ì‚¬ìš©ìë¡œ ì¸ì‹í•©ë‹ˆë‹¤.<br>\n    ",
      "background_korean": "\n<details> \n    <summary style='font-size: 18px;color:pink;'> ğŸ’¡ tx.originê³¼ msg.sender </summary><br />\n    \n`tx.origin`ê³¼ `msg.sender`ëŠ” solidity global variableë¡œì„œ, ë‘˜ ë‹¤ í˜¸ì¶œìì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n\n`tx.origin`ì€ íŠ¸ëœì­ì…˜ì„ ì²˜ìŒ ìƒì„±í•˜ê³  ë„¤íŠ¸ì›Œí¬ì— ì „ì†¡í•œ ê³„ì •ì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br>\në”°ë¼ì„œ `tx.origin`ì€ í•­ìƒ `EOA(Externally Owned Account)`ì˜ ì£¼ì†Œë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.<br>\në‹¤ì¤‘ ì„œëª… ì§€ê°‘ì„ êµ¬í˜„í•  ë•Œì™€ ê°™ì´ íŠ¸ëœì­ì…˜ì˜ ìµœì´ˆ ë°œì‹ ìë¥¼ ì‹ë³„í•´ì•¼ í•˜ëŠ” ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‘ì„±í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.<br>\n\n`msg.sender`ëŠ” í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê³„ì •ì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br>\nê·¸ë ‡ê¸° ë•Œë¬¸ì— `msg.sender`ëŠ” `EOA`ì˜ ì£¼ì†Œì¼ ìˆ˜ë„ ìˆê³ , `Contract`ì˜ ì£¼ì†Œì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.<br>\nì ‘ê·¼ ì œì–´ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ë•Œì™€ ê°™ì´ ë©”ì‹œì§€ì˜ í˜„ì¬ ë°œì‹ ìë¥¼ í™•ì¸í•´ì•¼ í•˜ëŠ” ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‘ì„±í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.<br>\n\n<br>\n\n<div class='mermaid'>\nflowchart LR\n     id1(EOA) --> id2(Contract A) --> id3(Contract B) --> id4(Contract C)\n</div>\n\n<br>\n\n`EOA`ê°€ `Contract A`ë¥¼ í˜¸ì¶œí•˜ê³ , `Contract A`ê°€ `Contract B`ë¥¼ í˜¸ì¶œí•˜ë©°, `Contract B`ê°€ `Contract C`ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, `Contract C`ì—ì„œ `msg.sender`ëŠ” `Contract B`ì´ê³ , `tx.origin`ì€ `EOA`ì…ë‹ˆë‹¤.<br>\n`msg.sender`ì™€ `tx.origin`ì€ ê°™ì€ ê³„ì •ì„ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, `tx.origin`ì€ í˜¸ì¶œìì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ìµœì´ˆë¡œ `Contract`ë¥¼ í˜¸ì¶œí•œ ê³„ì •ì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n</details>\n<br />\n    ",
      "exploit_scenario_korean": "\n```solidity\ncontract Wallet {\n    address public owner;\n\n    constructor() payable {\n        owner = msg.sender;\n    }\n\n    function transfer(address payable _to, uint _amount) public {\n        require(tx.origin == owner, \"Not owner\");\n\n        (bool sent, ) = _to.call{value: _amount}(\"\");\n        require(sent, \"Failed to send Ether\");\n    }\n}\n```\n\n`Alice`ê°€ `Wallet` ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•˜ê³ , ì•…ì˜ì ì¸ ì‚¬ìš©ì `Bob`ì´ `Alice`ë¥¼ ì†ì—¬ `Bob`ì˜ `Attack` ì»¨íŠ¸ë™íŠ¸ë¥¼ í˜¸ì¶œí•˜ë„ë¡ ìœ ë„í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.\n\n<br>\n\n```solidity\ncontract Attack {\n    address payable public owner;\n    Wallet wallet;\n\n    constructor(Wallet _wallet) {\n        wallet = Wallet(_wallet);\n        owner = payable(msg.sender);\n    }\n\n    function attack() public {\n        wallet.transfer(owner, address(wallet).balance);\n    }\n}\n```\n\n`Alice`ê°€ `Attack` ì»¨íŠ¸ë™íŠ¸ì˜ `attack` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, `Attack` ì»¨íŠ¸ë™íŠ¸ëŠ” `Wallet` ì»¨íŠ¸ë™íŠ¸ì˜ `transfer` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.<br>\n`Wallet` ì»¨íŠ¸ë™íŠ¸ì˜ `transfer` í•¨ìˆ˜ëŠ” `tx.origin`ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„ ìˆ˜í–‰í•˜ë¯€ë¡œ, `tx.origin`ì€ `Alice`ì˜ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.<br>\në”°ë¼ì„œ, `Attack` ì»¨íŠ¸ë™íŠ¸ëŠ” `Alice`ì˜ ì£¼ì†Œë¥¼ ê°€ì§„ `EOA`ë¡œ ì¸ì‹ë˜ì–´, Bobì€ Aliceì˜ `Wallet` ì»¨íŠ¸ë™íŠ¸ë¡œë¶€í„° ì´ë”ë¥¼ ì¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>\n\n    ",
      "examples_korean": "",
      "recommendation_korean": "\n`tx.origin`ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ì—ì„œ `tx.origin`ì„ ì‚¬ìš©í•˜ëŠ” ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì»¨íŠ¸ë™íŠ¸ ê°„ì˜ ìƒí˜¸ ìš´ìš©ì„±ì´ ì œí•œë©ë‹ˆë‹¤.<br>\në˜í•œ, 2016ë…„ 7ì›”, `Vitalik Buterin`ì´ [ethereum stackexchange](https://ethereum.stackexchange.com/questions/196/how-do-i-make-my-dapp-serenity-proof/200#200)ì— ë‚¨ê¸´ ë‹µë³€ì— ì˜í•˜ë©´, í–¥í›„ ì´ë”ë¦¬ì›€ í”„ë¡œí† ì½œì—ì„œ tx.originì„ ì œê±°í•  ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.<br>\n\nì•„ë˜ì™€ ê°™ì´ `tx.origin` ëŒ€ì‹  `msg.sender`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.\n\n```solidity\nfunction transfer(address payable _to, uint256 _amount) public {\n  require(msg.sender == owner);\n\n  (bool sent, ) = _to.call.value(_amount)(\"\");\n  require(sent, \"Failed to send Ether\");\n}\n```\n    ",
      "reference": "\n- https://ethereum.stackexchange.com/questions/1891/whats-the-difference-between-msg-sender-and-tx-origin\n- https://docs.soliditylang.org/en/v0.8.17/security-considerations.html#tx-origin\n- https://stackoverflow.com/questions/73554510/msg-sender-preferred-over-tx-origin-in-solidity\n- https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/\n- https://dev.to/zenodavids/avoiding-security-vulnerabilities-the-txorigin-vs-msgsender-debate-24an    \n    "
    }
  }
}