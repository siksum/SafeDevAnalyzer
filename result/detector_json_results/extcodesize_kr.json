{
  "incorrect-extcodesize": {
    "success": true,
    "error": null,
    "results": {
      "filename": "/Users/sikk/Desktop/Antibug/SafeDevAnalyzer/test/extcodesize.sol",
      "detector": "incorrect-extcodesize",
      "impact": "Informational",
      "confidence": "High",
      "element": [
        {
          "type": "function",
          "name": "isContract",
          "line": 5,
          "code": "    function isContract(address account) public view returns (bool) {\n",
          "parent_type": "contract",
          "parent_name": "Target"
        }
      ],
      "info_korean": "í•¨ìˆ˜ `Target.isContract(address)`ê°€ ì»¨íŠ¸ë™íŠ¸ì˜ í¬ê¸°ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ `extcodesize`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. `extcodesize` ëŒ€ì‹  `code.length`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\n",
      "description_korean": "\níŠ¹ì • ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì—ì„œëŠ” ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ `EOA`ì—ì„œë§Œ í˜¸ì¶œì„ í—ˆìš©í•˜ê³  ë‹¤ë¥¸ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì—ì„œëŠ” í˜¸ì¶œì„ í—ˆìš©í•˜ì§€ ì•Šë„ë¡ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nì´ëŸ¬í•œ ê²½ìš° í•¨ìˆ˜ê°€ ì»¨íŠ¸ë™íŠ¸ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ë ¤ë©´ ì£¼ì†Œì— ì½”ë“œê°€ ì €ì¥ë˜ì§€ ì•Šì€ `msg.sender`ë¥¼ ìš”êµ¬í•˜ê¸° ìœ„í•´ `require` ë¬¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ ì–´ì…ˆë¸”ë¦¬ì— ë‚´ì¥ëœ `extcodesize`ë¥¼ ì‚¬ìš©í•˜ì—¬ `EOA`ì¸ì§€ í™•ì¸í•˜ëŠ” ë¡œì§ì€ ê³µê²©ìê°€ ì‰½ê²Œ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì£¼ì†Œì˜ ì½”ë“œ í¬ê¸°ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì€ ì‚¬ìš©ìê°€ ì˜ì›íˆ ì ê¸¸ ìˆ˜ ìˆëŠ” ì»¨íŠ¸ë™íŠ¸ë¡œ ìê¸ˆì´ë‚˜ í† í°ì„ ì´ì²´í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” ë“± ì‚¬ìš©ìì—ê²Œ ì´ë“ì„ ì£¼ëŠ” ê²ƒì´ ëª©ì ì¼ ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.\ní•¨ìˆ˜ í˜¸ì¶œìê°€ `EOA`ì´ì–´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.\n\nì»¨íŠ¸ë™íŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ë™ì•ˆ í•´ë‹¹ ì£¼ì†Œê°€ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œì´ë”ë¼ë„ í•´ë‹¹ ì£¼ì†Œì— ëŒ€í•œ `extcodesize 0`ì„ ë°˜í™˜í•˜ê²Œ ë˜ì–´ ì»¨íŠ¸ë™íŠ¸ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n    ",
      "background_korean": "\n<details> \n    <summary style='font-size: 18px;color:pink;'> ğŸ’¡ Inline Assemblyë€? </summary><br />\n    \n`inline-assembly`ëŠ” EVMì— ì§ì ‘ì ìœ¼ë¡œ ìƒí˜¸ì‘ìš©í•˜ë©° high-levelì—ì„œ í•  ìˆ˜ ì—†ëŠ” ìˆ˜ì¤€ì˜ controlê³¼ ì •ë°€ë„ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.\n\nêµ¬ì²´ì ìœ¼ë¡œ, ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ì„ ì¡°ì •í•˜ê±°ë‚˜, íŠ¹ì • EVM ê¸°ëŠ¥ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nsolidityì—ì„œëŠ” EVM bytecodeë¡œ ì»´íŒŒì¼í•˜ë„ë¡ ì„¤ê³„ëœ ì¤‘ê°„ ì–¸ì–´ì¸ Yulì„ ì‚¬ìš©í•˜ì—¬ `inline-assembly`ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n    assembly{ â€¦ }\ní˜•íƒœë¡œ ì‘ì„±í•©ë‹ˆë‹¤.\n\n</details>\n<br />   \n    \n<details> \n    <summary style='font-size: 18px;color:pink;'> ğŸ’¡ extcodesize ë€? </summary><br />\n    \n`extcodesize` í•¨ìˆ˜ëŠ” Ethereumì˜ `EVM(Ethereum Virtual Machine)` ëª…ë ¹ì–´ ì¤‘ í•˜ë‚˜ë¡œ, íŠ¹ì • ì£¼ì†Œì— ë°°í¬ëœ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì˜ ì½”ë“œ í¬ê¸°ë¥¼ ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.\n`extcodesize` í•¨ìˆ˜ëŠ” contractë¥¼ í˜¸ì¶œí•œ ì£¼ì†Œê°€ `EOA(Externally Owned Accounts)`ì¸ì§€, `CA(Contract Accounts)`ì¸ì§€ í™•ì¸í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤.\nì»¨íŠ¸ë™íŠ¸ë¥¼ ìƒì„±í•  ë•ŒëŠ” ì•„ì§ ì½”ë“œê°€ ì—†ìœ¼ë¯€ë¡œ constructorë¡œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œëŠ” bytecodeì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nì¦‰, ì£¼ì†Œì˜ ì½”ë“œ í¬ê¸°ê°€ 0ë³´ë‹¤ í¬ë©´ í•´ë‹¹ ì£¼ì†ŒëŠ” `CA`ì´ë©°, 0ì´ë©´ `EOA`ì…ë‹ˆë‹¤.\n\n</details>\n<br />   \n    ",
      "exploit_scenario_korean": "\n```solidity\ncontract Target {\n    function isContract(address account) public view returns (bool) {\n        uint size;\n        assembly {\n            size := extcodesize(account)\n        }\n        return size > 0;\n    }\n\n    bool public pwned = false;\n\n    function protected() external {\n        require(!isContract(msg.sender), \"no contract allowed\");\n        pwned = true;\n    }\n}\n```\n`Target` ì»¨íŠ¸ë™íŠ¸ëŠ” `protected` í•¨ìˆ˜ë¥¼ í†µí•´ `EOA`ì—ì„œë§Œ í˜¸ì¶œì„ í—ˆìš©í•˜ê³  ë‹¤ë¥¸ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì—ì„œëŠ” í˜¸ì¶œì„ í—ˆìš©í•˜ì§€ ì•Šë„ë¡ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\n`extcodesize`ë¥¼ í†µí•´ `CA`ë¼ë©´ `pwned` ê°’ì„ `false`ë¡œ ìœ ì§€í•©ë‹ˆë‹¤.\n\n`protected` í•¨ìˆ˜ì—ì„œ require ë¬¸ì„ í†µí•´ msg.senderê°€ EOAì¸ì§€ í™•ì¸í•˜ì—¬ `msg.sender`ê°€ `EOA`ë¼ë©´ `pwned` ê°’ì„ `true`ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ ì–´ì…ˆë¸”ë¦¬ì— ë‚´ì¥ëœ `extcodesize`ë¥¼ ì‚¬ìš©í•˜ì—¬ `EOA`ì¸ì§€ í™•ì¸í•˜ëŠ” ë¡œì§ì€ ê³µê²©ìê°€ ì‰½ê²Œ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```solidity\ncontract Hack {\n    bool public isContract;\n    address public addr;\n\n    constructor(address _target) {\n        isContract = Target(_target).isContract(address(this));\n        addr = address(this);\n        Target(_target).protected();\n    }\n}\n```\nê³µê²©ìëŠ” constructorì— `Target` contractì˜ `isContract` í•¨ìˆ˜ì™€ `protected` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•˜ì—¬ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ë¥¼ í†µí•´ `pwned`ì˜ ê°’ì„ `true`ë¡œ ë³€ê²½í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. \n    ",
      "examples_korean": "",
      "recommendation_korean": "\nsolidity 0.8.0 ë²„ì „ë¶€í„° `code.length` ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```solidity\nfunction isContract(address _addr) view returns (bool) {\n  return _addr.code.length > 0;\n}\n```\n\nì£¼ì†Œê°€ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œì¸ì§€ í™•ì¸í•˜ë ¤ë©´ `code.length` ì†ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì•ˆì •ì ì…ë‹ˆë‹¤.\n    ",
      "reference": "\n- https://solidity-by-example.org/hacks/contract-size/\n- https://ethereum.stackexchange.com/questions/15641/how-does-a-contract-find-out-if-another-address-is-a-contract\n- https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/extcodesize-checks/    \n    "
    }
  }
}